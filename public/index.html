<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Trading Agent Dashboard V2</title>
<script src="https://cdn.plot.ly/plotly-latest.min.js"></script>

<style>
body{
  background:#111;
  color:white;
  font-family:Arial;
  padding:20px;
}
.card{
  background:#1a1a1a;
  padding:15px;
  margin:15px 0;
  border-radius:8px;
}
table{
  width:100%;
  border-collapse:collapse;
}
td,th{
  padding:8px;
  border-bottom:1px solid #333;
}
h2{margin-top:0}
</style>
</head>

<body>

<h1>ğŸš€ Trading Agent Dashboard</h1>
<div id="updated"></div>

<div class="card">
<h2>ğŸ“ˆ Equity Curves</h2>
<div id="equityChart"></div>
</div>

<div class="card">
<h2>ğŸ“Š Strategy Metrics</h2>
<table id="metricsTable"></table>
</div>

<div class="card">
<h2>ğŸ¯ Today's Signals</h2>
<div id="signals"></div>
</div>

<script>

fetch("public/dashboard_data.json?v=3")
.then(r=>{
    if(!r.ok){
        throw new Error("JSON load failed "+r.status)
    }
    return r.json()
})
.then(d=>{

console.log("DATA:", d)

// ---------- updated ----------
document.getElementById("updated").innerText =
"Updated: "+d.timestamp

// ---------- equity ----------
let traces=[]
for(const [k,e] of Object.entries(d.equity)){
    traces.push({
        y:e,
        mode:'lines',
        name:d.strategies[k].name
    })
}

Plotly.newPlot("equityChart",traces)

// ---------- metrics ----------
let html="<tr><th>Strategy</th><th>Return</th><th>Sharpe</th></tr>"

for(const [k,s] of Object.entries(d.strategies)){
    html+=`<tr>
    <td>${s.name}</td>
    <td>${s.metrics.return_pct}</td>
    <td>${s.metrics.sharpe}</td>
    </tr>`
}

document.getElementById("metricsTable").innerHTML=html

})
.catch(e=>{
    document.body.innerHTML += "<br><br>âŒ ERROR: "+e
    console.error(e)
})

</script>

</body>
</html>
